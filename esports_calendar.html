<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esports Calendar (CS2)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    <style>
        /* Fondo con gradiente dinÃ¡mico */
        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        /* Estilos para el header */
        .header {
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            padding: 1.5rem;
            border-radius: 0 0 1rem 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        .header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            color: #ffffff;
            text-align: center;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
        }

        /* Contenedor principal con efecto card */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 1.5rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }

        /* Estilos para FullCalendar en modo oscuro */
        .fc {
            color: #d1d5db;
            --fc-button-bg-color: #2563eb;
            --fc-button-border-color: #1e40af;
            --fc-button-hover-bg-color: #1e40af;
            --fc-button-active-bg-color: #1e3a8a;
        }
        .fc .fc-daygrid-day {
            background: #1f2937;
            border-color: #4b5563;
            transition: background 0.2s ease;
        }
        .fc .fc-daygrid-day:hover {
            background: #374151;
        }
        .fc .fc-daygrid-day.fc-day-today {
            background: #1e3a8a;
            font-weight: 600;
        }
        .fc .fc-col-header-cell {
            background: #374151;
            color: #d1d5db;
            border-color: #4b5563;
            font-weight: 500;
        }
        .fc .fc-event {
            color: #ffffff;
            font-size: 0.9em;
            border-radius: 0.375rem;
            padding: 2px 4px;
            transition: transform 0.2s ease;
        }
        .fc .fc-event:hover {
            transform: scale(1.05);
            filter: brightness(0.9);
        }
        .fc .fc-button {
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            transition: all 0.2s ease;
        }
        .fc .fc-button:hover {
            transform: translateY(-2px);
        }
        /* Colores personalizados para eventos */
        .event-blue { background: #2563eb; border-color: #1e40af; }
        .event-orange { background: #f97316; border-color: #ea580c; }
        .event-green { background: #16a34a; border-color: #15803d; }
        .event-red { background: #dc2626; border-color: #b91c1c; }
        .event-purple { background: #9333ea; border-color: #7e22ce; }
        .event-yellow { background: #eab308; border-color: #ca8a04; }

        /* Estilos para el modal de ayuda */
        #helpModal {
            z-index: 1000;
            overflow-y: auto;
        }
        #helpModal .bg-gray-800 {
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 1rem;
        }

        /* Estilos para modo claro */
        .light-mode {
            background: linear-gradient(135deg, #e0e7ff 0%, #f3f4f6 100%);
        }
        .light-mode .fc {
            color: #374151;
            --fc-button-bg-color: #3b82f6;
            --fc-button-border-color: #1d4ed8;
            --fc-button-hover-bg-color: #1d4ed8;
            --fc-button-active-bg-color: #1e40af;
        }
        .light-mode .fc .fc-daygrid-day {
            background: #f3f4f6;
            border-color: #d1d5db;
        }
        .light-mode .fc .fc-daygrid-day:hover {
            background: #e5e7eb;
        }
        .light-mode .fc .fc-daygrid-day.fc-day-today {
            background: #bfdbfe;
        }
        .light-mode .fc .fc-col-header-cell {
            background: #e5e7eb;
            color: #374151;
            border-color: #d1d5db;
        }
        .light-mode .fc .fc-event {
            color: #1f2937;
        }
        .light-mode .card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #e5e7eb;
        }
        .light-mode body {
            color: #1f2937;
        }
        .light-mode .bg-gray-800 {
            background-color: #ffffff;
        }
        .light-mode .bg-gray-700 {
            background-color: #e5e7eb;
        }
        .light-mode .text-gray-300 {
            color: #6b7280;
        }
        .light-mode .border-gray-600 {
            border-color: #d1d5db;
        }
        .light-mode .hover:bg-gray-700 {
            background-color: #d1d5db;
        }
        .light-mode input,
        .light-mode select {
            background-color: #ffffff;
            color: #1f2937;
            border-color: #d1d5db;
        }
        .light-mode input:focus,
        .light-mode select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .light-mode table {
            background-color: #ffffff;
        }
        .light-mode thead {
            background-color: #e5e7eb;
        }
        .light-mode .hover:bg-gray-700:hover {
            background-color: #d1d5db;
        }
        .light-mode footer {
            background-color: #f3f4f6;
            color: #1f2937;
            border-top: 1px solid #e5e7eb;
        }
        .light-mode footer a {
            color: #3b82f6;
        }
        .light-mode footer a:hover {
            color: #1d4ed8;
        }

        /* Estilos para inputs y selects */
        input, select {
            border-radius: 0.5rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        input:focus, select:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        /* Estilos para botones */
        button {
            border-radius: 0.75rem;
            transition: all 0.2s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para el footer */
        footer {
            background-color: #1f2937;
            color: #d1d5db;
            padding: 1.5rem;
            border-top: 1px solid #4b5563;
            text-align: center;
            margin-top: 2rem;
        }
        footer a {
            color: #60a5fa;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        footer a:hover {
            color: #3b82f6;
            text-decoration: underline;
        }

        /* Estilos para el selector de idioma con banderas */
        .language-switch {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .language-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: #2563eb;
            color: #ffffff;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .language-btn:hover {
            background-color: #1e40af;
            transform: scale(1.1);
        }
        .language-btn.active {
            background-color: #1e3a8a;
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 font-sans">
    <header class="header">
        <h1 id="pageTitle">Calendario de Esports (CS2)</h1>
    </header>
    <div class="container mx-auto p-4">
        <div class="flex justify-between items-center mb-6">
            <div class="language-switch">
                <button id="lang-es" class="language-btn" onclick="setLanguage('es')">ðŸ‡ªðŸ‡¸</button>
                <button id="lang-en" class="language-btn" onclick="setLanguage('en')">ðŸ‡ºðŸ‡¸</button>
            </div>
            <button id="toggleTheme" class="bg-blue-600 text-white p-2 rounded hover:bg-blue-700">Modo Claro</button>
        </div>
        <p id="storageNote" class="text-center text-gray-400 mb-6">Los datos se guardan localmente en tu navegador. Exporta tu calendario para respaldarlo o compartirlo. No compartas el archivo JSON si contiene informaciÃ³n sensible.</p>

        <!-- Calendario -->
        <div id="calendar" class="card mb-6"></div>

        <!-- Formulario para agregar/editar torneos -->
        <div class="card mb-6">
            <h2 id="formTitle" class="text-xl font-semibold mb-4 text-white">Agregar Nuevo Torneo</h2>
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                <input id="tournamentName" type="text" placeholder="Nombre del Torneo" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <select id="tournamentTier" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
                <div class="flex flex-col">
                    <label id="startDateLabel" for="startDate" class="text-sm text-gray-300">Fecha de Inicio</label>
                    <input id="startDate" type="date" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex flex-col">
                    <label id="endDateLabel" for="endDate" class="text-sm text-gray-300">Fecha de Fin</label>
                    <input id="endDate" type="date" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <input id="tournamentTeams" type="text" placeholder="Equipos (separados por coma)" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input id="tournamentLocation" type="text" placeholder="UbicaciÃ³n (ej. Londres, Online)" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <select id="tournamentModality" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="Online">Online</option>
                    <option value="Offline">Offline</option>
                    <option value="Online/Offline">Online/Offline</option>
                </select>
                <select id="tournamentColor" class="p-2 border rounded bg-gray-700 text-gray-100 border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
                <div class="flex items-center">
                    <input id="tournamentVRS" type="checkbox" class="mr-2 text-blue-500 focus:ring-blue-500">
                    <label id="vrsLabel" for="tournamentVRS" class="text-gray-300">Cuenta para el VRS</label>
                </div>
            </div>
            <div class="mt-4 flex gap-4 justify-center">
                <button id="saveButton" onclick="saveTournament()" class="bg-blue-600 text-white p-2 rounded hover:bg-blue-700">Agregar Torneo</button>
                <button id="cancelEditButton" onclick="cancelEdit()" class="hidden bg-gray-600 text-white p-2 rounded hover:bg-gray-700">Cancelar</button>
                <button id="exportButton" onclick="exportTournaments()" class="bg-green-600 text-white p-2 rounded hover:bg-green-700">Exportar</button>
                <input type="file" id="importFile" accept=".json" class="hidden" onchange="importTournaments(event)">
                <button id="importButton" onclick="document.getElementById('importFile').click()" class="bg-purple-600 text-white p-2 rounded hover:bg-purple-700">Importar</button>
                <button id="helpButton" onclick="showHelp()" class="bg-yellow-600 text-white p-2 rounded hover:bg-yellow-700">Ayuda</button>
                <button id="clearAllButton" onclick="confirmClearAll()" class="bg-red-600 text-white p-2 rounded hover:bg-red-700">Borrar todo</button>
            </div>
        </div>

        <!-- Tabla de torneos -->
        <div class="card">
            <table id="tournamentTable" class="min-w-full bg-gray-800 rounded-lg">
                <thead>
                    <tr class="bg-gray-700 text-gray-300 uppercase text-sm leading-normal">
                        <th id="thTournament" class="py-3 px-6 text-left">Torneo</th>
                        <th id="thTier" class="py-3 px-6 text-left">Tier</th>
                        <th id="thDates" class="py-3 px-6 text-left cursor-pointer" onclick="sortByDate()">Fechas</th>
                        <th id="thTeams" class="py-3 px-6 text-left">Equipos</th>
                        <th id="thLocation" class="py-3 px-6 text-left">UbicaciÃ³n</th>
                        <th id="thModality" class="py-3 px-6 text-left">Modalidad</th>
                        <th id="thColor" class="py-3 px-6 text-left">Color</th>
                        <th id="thVRS" class="py-3 px-6 text-left cursor-pointer" onclick="sortByVRS()">VRS</th>
                        <th id="thActions" class="py-3 px-6 text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody id="tournamentBody" class="text-gray-300 text-sm font-light">
                    <!-- Los torneos se agregarÃ¡n aquÃ­ dinÃ¡micamente -->
                </tbody>
            </table>
        </div>

        <!-- Modal de ayuda -->
        <div id="helpModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden flex items-center justify-center">
            <div class="bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full">
                <h3 id="helpTitle" class="text-xl font-semibold mb-4 text-white">Ayuda</h3>
                <p id="helpIntro" class="text-gray-300 mb-4">Bienvenido al Calendario de Esports (CS2). AquÃ­ tienes las instrucciones bÃ¡sicas:</p>
                <ul id="helpList" class="list-disc list-inside text-gray-300 mb-4">
                    <li><strong id="helpAdd">Agregar Torneo:</strong> Completa el formulario y haz clic en "Agregar Torneo".</li>
                    <li><strong id="helpEdit">Editar Torneo:</strong> Haz clic en "Editar" en la tabla o en un evento del calendario.</li>
                    <li><strong id="helpDelete">Eliminar Torneo:</strong> Haz clic en "Eliminar" y confirma.</li>
                    <li><strong id="helpExport">Exportar:</strong> Descarga un archivo JSON con tus torneos para respaldarlo o compartirlo.</li>
                    <li><strong id="helpImport">Importar:</strong> Selecciona un archivo JSON para cargar torneos previos.</li>
                    <li><strong id="helpClear">Borrar todo:</strong> Usa "Borrar todo" para eliminar todos los torneos (con confirmaciÃ³n).</li>
                    <li><strong id="helpNote">Nota:</strong> Los datos se guardan localmente. No compartas el JSON si contiene informaciÃ³n sensible.</li>
                </ul>
                <button id="closeHelp" onclick="hideHelp()" class="bg-blue-600 text-white p-2 rounded hover:bg-blue-700">Cerrar</button>
            </div>
        </div>
    </div>

    <footer class="bg-gray-800 text-gray-300 p-4 text-center w-full">
        <p>Â¿Tienes alguna pregunta? ContÃ¡ctame en: <a href="mailto:tujugador@email.com" class="text-blue-400 hover:underline">tujugador@email.com</a> | Sigue mis actualizaciones en <a href="https://x.com/tujugador" target="_blank" class="text-blue-400 hover:underline">X</a></p>
    </footer>

    <script>
        // Objeto con traducciones
        const translations = {
            es: {
                pageTitle: "Calendario de Esports (CS2)",
                storageNote: "Los datos se guardan localmente en tu navegador. Exporta tu calendario para respaldarlo o compartirlo. No compartas el archivo JSON si contiene informaciÃ³n sensible.",
                formTitle: "Agregar Nuevo Torneo",
                startDateLabel: "Fecha de Inicio",
                endDateLabel: "Fecha de Fin",
                vrsLabel: "Cuenta para el VRS",
                saveButton: "Agregar Torneo",
                cancelEditButton: "Cancelar",
                exportButton: "Exportar",
                importButton: "Importar",
                helpButton: "Ayuda",
                clearAllButton: "Borrar todo",
                thTournament: "Torneo",
                thTier: "Tier",
                thDates: "Fechas",
                thTeams: "Equipos",
                thLocation: "UbicaciÃ³n",
                thModality: "Modalidad",
                thColor: "Color",
                thVRS: "VRS",
                thActions: "Acciones",
                helpTitle: "Ayuda",
                helpIntro: "Bienvenido al Calendario de Esports (CS2). AquÃ­ tienes las instrucciones bÃ¡sicas:",
                helpAdd: "Agregar Torneo:",
                helpEdit: "Editar Torneo:",
                helpDelete: "Eliminar Torneo:",
                helpExport: "Exportar:",
                helpImport: "Importar:",
                helpClear: "Borrar todo:",
                helpNote: "Nota:",
                closeHelp: "Cerrar",
                confirmClear: "Â¿EstÃ¡s seguro de que deseas borrar todos los torneos? Esta acciÃ³n no se puede deshacer. Te recomendamos exportar tus datos primero.",
                clearSuccess: "Todos los torneos han sido borrados.",
                incompleteFields: "Por favor, completa todos los campos.",
                invalidDate: "La fecha de fin no puede ser anterior a la fecha de inicio.",
                noTournaments: "No hay torneos para exportar.",
                placeholderName: "Nombre del Torneo",
                placeholderTeams: "Equipos (separados por coma)",
                placeholderLocation: "UbicaciÃ³n (ej. Londres, Online)",
                tierOptions: ["S (MÃ¡xima Relevancia)", "A", "B", "C"],
                colorOptions: ["Azul", "Naranja", "Verde", "Rojo", "Violeta", "Amarillo"],
                calendarButtons: {
                    today: "Hoy",
                    month: "Mes",
                    week: "Semana",
                    day: "DÃ­a"
                }
            },
            en: {
                pageTitle: "Esports Calendar (CS2)",
                storageNote: "Data is saved locally in your browser. Export your calendar for backup or sharing. Do not share the JSON file if it contains sensitive information.",
                formTitle: "Add New Tournament",
                startDateLabel: "Start Date",
                endDateLabel: "End Date",
                vrsLabel: "Count for VRS",
                saveButton: "Add Tournament",
                cancelEditButton: "Cancel",
                exportButton: "Export",
                importButton: "Import",
                helpButton: "Help",
                clearAllButton: "Clear All",
                thTournament: "Tournament",
                thTier: "Tier",
                thDates: "Dates",
                thTeams: "Teams",
                thLocation: "Location",
                thModality: "Modality",
                thColor: "Color",
                thVRS: "VRS",
                thActions: "Actions",
                helpTitle: "Help",
                helpIntro: "Welcome to the Esports Calendar (CS2). Here are the basic instructions:",
                helpAdd: "Add Tournament:",
                helpEdit: "Edit Tournament:",
                helpDelete: "Delete Tournament:",
                helpExport: "Export:",
                helpImport: "Import:",
                helpClear: "Clear All:",
                helpNote: "Note:",
                closeHelp: "Close",
                confirmClear: "Are you sure you want to clear all tournaments? This action cannot be undone. We recommend exporting your data first.",
                clearSuccess: "All tournaments have been cleared.",
                incompleteFields: "Please fill in all fields.",
                invalidDate: "The end date cannot be earlier than the start date.",
                noTournaments: "There are no tournaments to export.",
                placeholderName: "Tournament Name",
                placeholderTeams: "Teams (comma separated)",
                placeholderLocation: "Location (e.g. London, Online)",
                tierOptions: ["S (Highest Relevance)", "A", "B", "C"],
                colorOptions: ["Blue", "Orange", "Green", "Red", "Purple", "Yellow"],
                calendarButtons: {
                    today: "Today",
                    month: "Month",
                    week: "Week",
                    day: "Day"
                }
            }
        };

        let currentLang = 'es';
        let isDarkMode = true; // Modo inicial es oscuro

        // FunciÃ³n para cambiar idioma
        function setLanguage(lang) {
            currentLang = lang;
            document.getElementById('pageTitle').textContent = translations[lang].pageTitle;
            document.getElementById('storageNote').textContent = translations[lang].storageNote;
            document.getElementById('formTitle').textContent = translations[lang].formTitle;
            document.getElementById('startDateLabel').textContent = translations[lang].startDateLabel;
            document.getElementById('endDateLabel').textContent = translations[lang].endDateLabel;
            document.getElementById('vrsLabel').textContent = translations[lang].vrsLabel;
            document.getElementById('saveButton').textContent = translations[lang].saveButton;
            document.getElementById('cancelEditButton').textContent = translations[lang].cancelEditButton;
            document.getElementById('exportButton').textContent = translations[lang].exportButton;
            document.getElementById('importButton').textContent = translations[lang].importButton;
            document.getElementById('helpButton').textContent = translations[lang].helpButton;
            document.getElementById('clearAllButton').textContent = translations[lang].clearAllButton;
            document.getElementById('thTournament').textContent = translations[lang].thTournament;
            document.getElementById('thTier').textContent = translations[lang].thTier;
            document.getElementById('thDates').textContent = translations[lang].thDates;
            document.getElementById('thTeams').textContent = translations[lang].thTeams;
            document.getElementById('thLocation').textContent = translations[lang].thLocation;
            document.getElementById('thModality').textContent = translations[lang].thModality;
            document.getElementById('thColor').textContent = translations[lang].thColor;
            document.getElementById('thVRS').textContent = translations[lang].thVRS;
            document.getElementById('thActions').textContent = translations[lang].thActions;
            document.getElementById('helpTitle').textContent = translations[lang].helpTitle;
            document.getElementById('helpIntro').textContent = translations[lang].helpIntro;
            document.getElementById('helpAdd').textContent = translations[lang].helpAdd;
            document.getElementById('helpEdit').textContent = translations[lang].helpEdit;
            document.getElementById('helpDelete').textContent = translations[lang].helpDelete;
            document.getElementById('helpExport').textContent = translations[lang].helpExport;
            document.getElementById('helpImport').textContent = translations[lang].helpImport;
            document.getElementById('helpClear').textContent = translations[lang].helpClear;
            document.getElementById('helpNote').textContent = translations[lang].helpNote;
            document.getElementById('closeHelp').textContent = translations[lang].closeHelp;
            document.getElementById('tournamentName').placeholder = translations[lang].placeholderName;
            document.getElementById('tournamentTeams').placeholder = translations[lang].placeholderTeams;
            document.getElementById('tournamentLocation').placeholder = translations[lang].placeholderLocation;

            // Actualizar opciones de tournamentTier
            const tierSelect = document.getElementById('tournamentTier');
            tierSelect.innerHTML = '';
            translations[lang].tierOptions.forEach((optionText, index) => {
                const option = document.createElement('option');
                option.value = ['S', 'A', 'B', 'C'][index];
                option.text = optionText;
                tierSelect.appendChild(option);
            });

            // Actualizar opciones de tournamentColor
            const colorSelect = document.getElementById('tournamentColor');
            colorSelect.innerHTML = '';
            translations[lang].colorOptions.forEach((colorName, index) => {
                const option = document.createElement('option');
                option.value = ['blue', 'orange', 'green', 'red', 'purple', 'yellow'][index];
                option.text = colorName;
                colorSelect.appendChild(option);
            });

            // Restaurar la selecciÃ³n actual si existe
            const currentTier = tierSelect.value;
            const currentColor = colorSelect.value;
            if (currentTier) tierSelect.value = currentTier;
            if (currentColor) colorSelect.value = currentColor;

            // Actualizar el locale y los botones del calendario
            calendar.setOption('locale', lang === 'es' ? 'es' : 'en');
            calendar.setOption('buttonText', translations[lang].calendarButtons);

            // Actualizar la clase active en los botones de idioma
            document.getElementById('lang-es').classList.toggle('active', lang === 'es');
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');

            renderCalendar();
        }

        // FunciÃ³n para alternar entre modo claro y oscuro
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-mode', !isDarkMode);
            document.getElementById('toggleTheme').textContent = isDarkMode ? 'Modo Claro' : 'Modo Oscuro';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        // Array para almacenar los torneos
        let tournaments = [];
        let sortDirectionDate = 1; // 1 para ascendente, -1 para descendente
        let sortDirectionVRS = 1; // 1 para SÃ­ primero, -1 para No primero
        let editingTournamentId = null; // ID del torneo en ediciÃ³n
        let calendar; // Instancia de FullCalendar

        // FunciÃ³n para formatear fechas a DD/MM/YYYY
        function formatDate(dateString) {
            const date = new Date(dateString);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }

        // Cargar torneos y tema desde localStorage al iniciar
        function loadTournamentsAndTheme() {
            const savedTournaments = localStorage.getItem('tournaments');
            if (savedTournaments) {
                tournaments = JSON.parse(savedTournaments);
                renderTournaments();
                renderCalendar();
            }
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                toggleTheme(); // Aplica modo claro si fue guardado
            }
            // Activar el idioma inicial
            document.getElementById('lang-es').classList.add('active');
        }

        // Guardar torneos en localStorage
        function saveTournaments() {
            localStorage.setItem('tournaments', JSON.stringify(tournaments));
        }

        // FunciÃ³n para inicializar el calendario
        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                events: [],
                eventClick: function(info) {
                    editTournament(parseInt(info.event.id));
                },
                eventDisplay: 'block',
                eventTimeFormat: { hour: 'numeric', minute: '2-digit', hour12: false },
                firstDay: 1,
                locale: 'es',
                buttonText: translations[currentLang].calendarButtons
            });
            calendar.render();
        }

        // FunciÃ³n para renderizar el calendario
        function renderCalendar() {
            calendar.removeAllEvents();
            tournaments.forEach(tournament => {
                const start = new Date(tournament.startDate);
                const end = new Date(tournament.endDate);
                end.setDate(end.getDate() + 1);
                calendar.addEvent({
                    id: tournament.id,
                    title: `${tournament.name} (${tournament.teams}, ${tournament.location}, ${tournament.modality}, ${formatDate(tournament.startDate)} - ${formatDate(tournament.endDate)})`,
                    start: start.toISOString().split('T')[0],
                    end: end.toISOString().split('T')[0],
                    classNames: [`event-${tournament.color}`],
                    extendedProps: { tier: tournament.tier, vrs: tournament.vrs, location: tournament.location, modality: tournament.modality }
                });
            });
        }

        // FunciÃ³n para guardar un torneo (agregar o editar)
        function saveTournament() {
            const name = document.getElementById('tournamentName').value;
            const tier = document.getElementById('tournamentTier').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const teams = document.getElementById('tournamentTeams').value;
            const location = document.getElementById('tournamentLocation').value;
            const modality = document.getElementById('tournamentModality').value;
            const color = document.getElementById('tournamentColor').value;
            const vrs = document.getElementById('tournamentVRS').checked;

            if (name && tier && startDate && endDate && teams && location && modality && color) {
                if (new Date(endDate) < new Date(startDate)) {
                    alert(translations[currentLang].invalidDate);
                    return;
                }

                if (editingTournamentId) {
                    tournaments = tournaments.map(tournament =>
                        tournament.id === editingTournamentId
                            ? { ...tournament, name, tier, startDate, endDate, teams, location, modality, color, vrs }
                            : tournament
                    );
                } else {
                    const tournament = { id: Date.now(), name, tier, startDate, endDate, teams, location, modality, color, vrs };
                    tournaments.push(tournament);
                }

                saveTournaments();
                renderTournaments();
                renderCalendar();
                cancelEdit();
            } else {
                alert(translations[currentLang].incompleteFields);
            }
        }

        // FunciÃ³n para editar un torneo
        function editTournament(id) {
            const tournament = tournaments.find(t => t.id === id);
            if (tournament) {
                document.getElementById('tournamentName').value = tournament.name;
                document.getElementById('tournamentTier').value = tournament.tier;
                document.getElementById('tournamentLocation').value = tournament.location;
                document.getElementById('tournamentModality').value = tournament.modality;
                document.getElementById('startDate').value = tournament.startDate;
                document.getElementById('endDate').value = tournament.endDate;
                document.getElementById('tournamentTeams').value = tournament.teams;
                document.getElementById('tournamentColor').value = tournament.color;
                document.getElementById('tournamentVRS').checked = tournament.vrs;
                document.getElementById('formTitle').textContent = translations[currentLang].formTitle.replace('Agregar', 'Editar');
                document.getElementById('saveButton').textContent = translations[currentLang].saveButton.replace('Agregar', 'Guardar Cambios');
                document.getElementById('cancelEditButton').classList.remove('hidden');
                editingTournamentId = id;
            }
        }

        // FunciÃ³n para cancelar la ediciÃ³n
        function cancelEdit() {
            editingTournamentId = null;
            document.getElementById('formTitle').textContent = translations[currentLang].formTitle;
            document.getElementById('saveButton').textContent = translations[currentLang].saveButton;
            document.getElementById('cancelEditButton').classList.add('hidden');
            clearForm();
        }

        // FunciÃ³n para ordenar por fecha de inicio
        function sortByDate() {
            tournaments.sort((a, b) => {
                return sortDirectionDate * (new Date(a.startDate) - new Date(b.startDate));
            });
            sortDirectionDate = -sortDirectionDate;
            renderTournaments();
        }

        // FunciÃ³n para ordenar por VRS
        function sortByVRS() {
            tournaments.sort((a, b) => {
                return sortDirectionVRS * (b.vrs - a.vrs);
            });
            sortDirectionVRS = -sortDirectionVRS;
            renderTournaments();
        }

        // FunciÃ³n para renderizar la tabla de torneos
        function renderTournaments() {
            const tbody = document.getElementById('tournamentBody');
            tbody.innerHTML = '';

            tournaments.forEach(tournament => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-600 hover:bg-gray-700 transition-colors duration-200';
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${tournament.name}</td>
                    <td class="py-3 px-6 text-left">${tournament.tier}</td>
                    <td class="py-3 px-6 text-left">${formatDate(tournament.startDate)} - ${formatDate(tournament.endDate)}</td>
                    <td class="py-3 px-6 text-left">${tournament.teams}</td>
                    <td class="py-3 px-6 text-left">${tournament.location}</td>
                    <td class="py-3 px-6 text-left">${tournament.modality}</td>
                    <td class="py-3 px-6 text-left">
                        <span class="inline-block w-4 h-4 rounded-full event-${tournament.color}"></span>
                        ${tournament.color.charAt(0).toUpperCase() + tournament.color.slice(1)}
                    </td>
                    <td class="py-3 px-6 text-left">${tournament.vrs ? translations[currentLang].thVRS === 'VRS' ? 'Yes' : 'SÃ­' : translations[currentLang].thVRS === 'VRS' ? 'No' : 'No'}</td>
                    <td class="py-3 px-6 text-center flex gap-2 justify-center">
                        <button onclick="editTournament(${tournament.id})" class="bg-yellow-600 text-white px-2 py-1 rounded hover:bg-yellow-700">Editar</button>
                        <button onclick="confirmDelete(${tournament.id})" class="bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // FunciÃ³n para confirmar eliminaciÃ³n
        function confirmDelete(id) {
            if (confirm(translations[currentLang].helpDelete.replace(':', '') + ' ' + translations[currentLang].confirmClear.split('?')[0] + '?')) {
                deleteTournament(id);
            }
        }

        // FunciÃ³n para eliminar un torneo
        function deleteTournament(id) {
            tournaments = tournaments.filter(tournament => tournament.id !== id);
            saveTournaments();
            renderTournaments();
            renderCalendar();
        }

        // FunciÃ³n para limpiar el formulario
        function clearForm() {
            document.getElementById('tournamentName').value = '';
            document.getElementById('tournamentTier').value = 'S';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('tournamentTeams').value = '';
            document.getElementById('tournamentLocation').value = '';
            document.getElementById('tournamentModality').value = 'Online';
            document.getElementById('tournamentColor').value = 'blue';
            document.getElementById('tournamentVRS').checked = false;
        }

        // FunciÃ³n para exportar los torneos
        function exportTournaments() {
            const data = localStorage.getItem('tournaments');
            if (data) {
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'tournaments_backup.json';
                a.click();
                URL.revokeObjectURL(url);
            } else {
                alert(translations[currentLang].noTournaments);
            }
        }

        // FunciÃ³n para importar los torneos
        function importTournaments(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = e.target.result;
                        localStorage.setItem('tournaments', importedData);
                        tournaments = JSON.parse(importedData);
                        renderTournaments();
                        renderCalendar();
                        alert(translations[currentLang].helpImport.replace(':', '') + ' ' + translations[currentLang].clearSuccess.toLowerCase().replace('cleared', 'imported'));
                    } catch (error) {
                        alert(translations[currentLang].helpImport.replace(':', '') + ' ' + 'error. Ensure the file is a valid JSON.');
                    }
                };
                reader.readAsText(file);
                event.target.value = '';
            }
        }

        // FunciÃ³n para confirmar y borrar todos los torneos
        function confirmClearAll() {
            if (confirm(translations[currentLang].confirmClear)) {
                clearAllTournaments();
            }
        }

        // FunciÃ³n para borrar todos los torneos
        function clearAllTournaments() {
            tournaments = [];
            localStorage.removeItem('tournaments');
            renderTournaments();
            renderCalendar();
            alert(translations[currentLang].clearSuccess);
        }

        // FunciÃ³n para mostrar la ayuda
        function showHelp() {
            document.getElementById('helpModal').classList.remove('hidden');
        }

        // FunciÃ³n para ocultar la ayuda
        function hideHelp() {
            document.getElementById('helpModal').classList.add('hidden');
        }

        // Inicializar el calendario y cargar los torneos al iniciar la pÃ¡gina
        document.addEventListener('DOMContentLoaded', () => {
            initCalendar();
            loadTournamentsAndTheme();
            setLanguage(currentLang);
            document.getElementById('toggleTheme').addEventListener('click', toggleTheme);
        });
    </script>
</body>
</html>
